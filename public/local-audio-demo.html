<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Greek Civilization - Complete Audio Demo</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #000;
      color: #fff;
      overflow: hidden;
    }

    #container {
      position: relative;
      width: 100vw;
      height: 100vh;
      display: flex;
      flex-direction: column;
    }

    #imageDisplay {
      position: relative;
      flex: 1;
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }

    #currentImage {
      max-width: 90%;
      max-height: 90%;
      object-fit: contain;
      opacity: 0;
      transition: opacity 0.6s ease-in-out;
      box-shadow: 0 20px 60px rgba(0,0,0,0.5);
      border-radius: 8px;
    }

    #currentImage.visible {
      opacity: 1;
    }

    #caption {
      position: absolute;
      bottom: 80px;
      left: 0;
      right: 0;
      background: linear-gradient(to top, rgba(0,0,0,0.9), transparent);
      padding: 50px 80px 30px;
      opacity: 0;
      transition: opacity 0.6s ease-in-out;
    }

    #caption.visible {
      opacity: 1;
    }

    #captionText {
      font-size: 36px;
      font-weight: 600;
      margin-bottom: 12px;
      text-shadow: 2px 2px 8px rgba(0,0,0,0.8);
      letter-spacing: 0.5px;
    }

    #captionCredit {
      font-size: 18px;
      opacity: 0.7;
      text-shadow: 1px 1px 4px rgba(0,0,0,0.8);
    }

    #controlPanel {
      background: rgba(20, 20, 20, 0.95);
      padding: 25px 50px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-top: 2px solid rgba(76, 175, 80, 0.3);
    }

    #controls {
      display: flex;
      gap: 20px;
      align-items: center;
    }

    button {
      background: linear-gradient(135deg, #4CAF50, #45a049);
      color: white;
      border: none;
      padding: 14px 28px;
      font-size: 17px;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 600;
      box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
    }

    button:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 20px rgba(76, 175, 80, 0.4);
    }

    button:disabled {
      background: linear-gradient(135deg, #555, #444);
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    button.danger {
      background: linear-gradient(135deg, #f44336, #da190b);
    }

    #status {
      display: flex;
      flex-direction: column;
      gap: 10px;
      flex: 1;
      max-width: 600px;
      margin-left: 30px;
    }

    #statusText {
      font-size: 15px;
      color: #aaa;
      font-weight: 500;
    }

    #statusText.active {
      color: #4CAF50;
    }

    #progressBar {
      width: 100%;
      height: 6px;
      background: rgba(255,255,255,0.1);
      border-radius: 3px;
      overflow: hidden;
    }

    #progressFill {
      height: 100%;
      background: linear-gradient(90deg, #4CAF50, #8BC34A);
      width: 0%;
      transition: width 0.3s ease;
      box-shadow: 0 0 10px rgba(76, 175, 80, 0.5);
    }

    #stats {
      position: fixed;
      top: 25px;
      left: 25px;
      background: rgba(20, 20, 20, 0.95);
      padding: 20px;
      border-radius: 10px;
      font-size: 14px;
      min-width: 280px;
      border: 2px solid rgba(76, 175, 80, 0.3);
      box-shadow: 0 8px 24px rgba(0,0,0,0.3);
    }

    #stats h3 {
      margin-bottom: 15px;
      font-size: 18px;
      color: #4CAF50;
      border-bottom: 1px solid rgba(76, 175, 80, 0.3);
      padding-bottom: 10px;
    }

    #stats .stat-row {
      display: flex;
      justify-content: space-between;
      padding: 6px 0;
    }

    #stats .stat-label {
      color: #aaa;
    }

    #stats .stat-value {
      color: #fff;
      font-weight: 600;
    }

    .badge {
      display: inline-block;
      padding: 5px 12px;
      background: rgba(76, 175, 80, 0.2);
      border: 1px solid rgba(76, 175, 80, 0.4);
      border-radius: 6px;
      font-size: 12px;
      font-weight: 600;
      color: #4CAF50;
      margin-top: 10px;
    }

    #audioIndicator {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 10px 18px;
      background: rgba(76, 175, 80, 0.15);
      border-radius: 8px;
      border: 2px solid rgba(76, 175, 80, 0.3);
    }

    #audioIndicator.playing {
      animation: pulse 1.5s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% { border-color: rgba(76, 175, 80, 0.3); }
      50% { border-color: rgba(76, 175, 80, 0.8); }
    }

    .audio-bars {
      display: flex;
      gap: 4px;
      height: 20px;
      align-items: flex-end;
    }

    .audio-bar {
      width: 4px;
      background: linear-gradient(180deg, #8BC34A, #4CAF50);
      border-radius: 2px;
      transition: height 0.1s ease;
    }

    .audio-bar.bar1 { height: 6px; }
    .audio-bar.bar2 { height: 12px; }
    .audio-bar.bar3 { height: 18px; }

    #audioIndicator.playing .audio-bar {
      animation: audioBar 0.6s ease-in-out infinite;
    }

    #audioIndicator.playing .audio-bar.bar1 { animation-delay: 0s; }
    #audioIndicator.playing .audio-bar.bar2 { animation-delay: 0.15s; }
    #audioIndicator.playing .audio-bar.bar3 { animation-delay: 0.3s; }

    @keyframes audioBar {
      0%, 100% { height: 6px; }
      50% { height: 20px; }
    }

    #intro {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
      z-index: 10;
    }

    #intro h1 {
      font-size: 48px;
      margin-bottom: 20px;
      color: #4CAF50;
      text-shadow: 0 0 20px rgba(76, 175, 80, 0.5);
    }

    #intro p {
      font-size: 20px;
      color: #aaa;
      margin-bottom: 10px;
    }

    #intro.hidden {
      display: none;
    }
  </style>
</head>
<body>
  <div id="container">
    <div id="imageDisplay">
      <div id="intro">
        <h1>üèõÔ∏è Ancient Greece</h1>
        <p>An Immersive Audio Experience</p>
        <p style="font-size: 16px; margin-top: 20px; opacity: 0.6;">Click "Start Experience" below</p>
      </div>
      <img id="currentImage" alt="Greek Civilization">
      <div id="caption">
        <div id="captionText"></div>
        <div id="captionCredit"></div>
      </div>
    </div>

    <div id="controlPanel">
      <div id="controls">
        <button id="startBtn">üé¨ Start Experience</button>
        <button id="stopBtn" disabled class="danger">‚èπÔ∏è Stop</button>

        <div id="audioIndicator">
          <div class="audio-bars">
            <div class="audio-bar bar1"></div>
            <div class="audio-bar bar2"></div>
            <div class="audio-bar bar3"></div>
          </div>
          <span id="audioStatus">Ready</span>
        </div>
      </div>
      <div id="status">
        <div id="statusText">Ready to begin your journey</div>
        <div id="progressBar">
          <div id="progressFill"></div>
        </div>
      </div>
    </div>
  </div>

  <div id="stats">
    <h3>üìä Experience Status</h3>
    <div class="stat-row">
      <span class="stat-label">Words Spoken:</span>
      <span class="stat-value" id="wordsValue">0 / 79</span>
    </div>
    <div class="stat-row">
      <span class="stat-label">Images Shown:</span>
      <span class="stat-value" id="imagesValue">0 / 2</span>
    </div>
    <div class="stat-row">
      <span class="stat-label">Progress:</span>
      <span class="stat-value" id="progressValue">0%</span>
    </div>
    <span class="badge">‚úì Browser TTS ‚Ä¢ Web Audio API</span>
  </div>

  <script>
    const GREEK_SCRIPT = {
      text: `Welcome to ancient Greece, the cradle of Western civilization.
Before you stands the Parthenon, the most iconic symbol of ancient Athens.
Built in 447 BC, this magnificent temple was dedicated to the goddess Athena.
The Acropolis of Athens rises majestically above the city.
Here, democracy was born and philosophy flourished.
Greek civilization gave us mathematics, theater, and the Olympic Games.
Their influence echoes through the millennia.`,
      images: [
        {
          id: 'parthenon',
          url: 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="1920" height="1080"%3E%3Cdefs%3E%3ClinearGradient id="g" x1="0" y1="0" x2="0" y2="1"%3E%3Cstop offset="0" stop-color="%23c9a060"/%3E%3Cstop offset="1" stop-color="%23967842"/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect fill="%23e8d4a6" width="1920" height="1080"/%3E%3Ctext x="960" y="200" fill="%23333" font-size="64" text-anchor="middle" font-family="Georgia,serif" font-weight="bold"%3EThe Parthenon%3C/text%3E%3Crect x="760" y="350" width="400" height="400" fill="url(%23g)"/%3E%3Crect x="780" y="370" width="60" height="340" fill="%23f4e9d1"/%3E%3Crect x="850" y="370" width="60" height="340" fill="%23f4e9d1"/%3E%3Crect x="920" y="370" width="60" height="340" fill="%23f4e9d1"/%3E%3Crect x="990" y="370" width="60" height="340" fill="%23f4e9d1"/%3E%3Crect x="1060" y="370" width="60" height="340" fill="%23f4e9d1"/%3E%3Cpolygon points="960,280 760,350 1160,350" fill="url(%23g)"/%3E%3Ctext x="960" y="900" fill="%23666" font-size="32" text-anchor="middle" font-family="Georgia,serif"%3EAthens, 447 BC%3C/text%3E%3C/svg%3E',
          showAtWord: 10,
          caption: 'The Parthenon ‚Äî Athens, 447 BC',
          credit: 'Temple of Athena Parthenos'
        },
        {
          id: 'acropolis',
          url: 'data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" width="1920" height="1080"%3E%3Cdefs%3E%3ClinearGradient id="sky" x1="0" y1="0" x2="0" y2="1"%3E%3Cstop offset="0" stop-color="%2387CEEB"/%3E%3Cstop offset="1" stop-color="%234682B4"/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect fill="url(%23sky)" width="1920" height="1080"/%3E%3Cellipse cx="960" cy="900" rx="900" ry="200" fill="%23d4a574"/%3E%3Ctext x="960" y="180" fill="white" font-size="64" text-anchor="middle" font-family="Georgia,serif" font-weight="bold" style="text-shadow:2px 2px 4px %23000"%3EThe Acropolis%3C/text%3E%3Crect x="400" y="500" width="1120" height="300" fill="%23c9a060"/%3E%3Crect x="440" y="520" width="50" height="250" fill="%23f4e9d1"/%3E%3Crect x="540" y="520" width="50" height="250" fill="%23f4e9d1"/%3E%3Crect x="640" y="520" width="50" height="250" fill="%23f4e9d1"/%3E%3Crect x="740" y="520" width="50" height="250" fill="%23f4e9d1"/%3E%3Crect x="840" y="520" width="50" height="250" fill="%23f4e9d1"/%3E%3Crect x="940" y="520" width="50" height="250" fill="%23f4e9d1"/%3E%3Crect x="1040" y="520" width="50" height="250" fill="%23f4e9d1"/%3E%3Crect x="1140" y="520" width="50" height="250" fill="%23f4e9d1"/%3E%3Crect x="1240" y="520" width="50" height="250" fill="%23f4e9d1"/%3E%3Crect x="1340" y="520" width="50" height="250" fill="%23f4e9d1"/%3E%3Crect x="1430" y="520" width="50" height="250" fill="%23f4e9d1"/%3E%3Cpolygon points="960,450 400,500 1520,500" fill="%23c9a060"/%3E%3Ctext x="960" y="1000" fill="%23333" font-size="32" text-anchor="middle" font-family="Georgia,serif"%3ECitadel of Ancient Athens%3C/text%3E%3C/svg%3E',
          showAtWord: 35,
          caption: 'The Acropolis of Athens',
          credit: 'Sacred Hill of Ancient Greece'
        }
      ]
    };

    let state = {
      wordCount: 0,
      imagesShown: 0,
      isNarrating: false,
      totalWords: GREEK_SCRIPT.text.split(/\s+/).length,
      utterance: null
    };

    const startBtn = document.getElementById('startBtn');
    const stopBtn = document.getElementById('stopBtn');
    const statusText = document.getElementById('statusText');
    const progressFill = document.getElementById('progressFill');
    const currentImage = document.getElementById('currentImage');
    const caption = document.getElementById('caption');
    const captionText = document.getElementById('captionText');
    const captionCredit = document.getElementById('captionCredit');
    const audioIndicator = document.getElementById('audioIndicator');
    const audioStatus = document.getElementById('audioStatus');
    const intro = document.getElementById('intro');

    function updateStatus(text, active = false) {
      statusText.textContent = text;
      statusText.className = active ? 'active' : '';
    }

    function updateStats() {
      document.getElementById('wordsValue').textContent =
        `${state.wordCount} / ${state.totalWords}`;
      document.getElementById('imagesValue').textContent =
        `${state.imagesShown} / 2`;
      const progress = Math.round((state.wordCount / state.totalWords) * 100);
      document.getElementById('progressValue').textContent = `${progress}%`;
    }

    function showImage(imageData) {
      currentImage.classList.remove('visible');
      caption.classList.remove('visible');

      setTimeout(() => {
        currentImage.src = imageData.url;
        captionText.textContent = imageData.caption;
        captionCredit.textContent = imageData.credit;

        setTimeout(() => {
          currentImage.classList.add('visible');
          caption.classList.add('visible');
          state.imagesShown++;
          updateStats();
        }, 100);
      }, 600);
    }

    async function startExperience() {
      try {
        startBtn.disabled = true;
        intro.classList.add('hidden');

        updateStatus('üéôÔ∏è Initializing narration...', true);
        progressFill.style.width = '5%';

        const synth = window.speechSynthesis;
        const utterance = new SpeechSynthesisUtterance(GREEK_SCRIPT.text);
        state.utterance = utterance;

        // Get voices
        let voices = synth.getVoices();
        if (voices.length === 0) {
          await new Promise(resolve => {
            synth.onvoiceschanged = () => {
              voices = synth.getVoices();
              resolve();
            };
            setTimeout(resolve, 1000);
          });
        }

        // Select best voice
        const enVoice = voices.find(v => v.lang.startsWith('en-')) || voices[0];
        if (enVoice) {
          utterance.voice = enVoice;
          console.log('Using voice:', enVoice.name);
        }

        utterance.rate = 0.85;
        utterance.pitch = 1.0;
        utterance.volume = 1.0;

        let wordsSoFar = 0;

        utterance.onboundary = (event) => {
          if (event.name === 'word') {
            wordsSoFar++;
            state.wordCount = wordsSoFar;

            // Check for image transitions
            GREEK_SCRIPT.images.forEach(img => {
              if (wordsSoFar === img.showAtWord) {
                showImage(img);
              }
            });

            const progress = (wordsSoFar / state.totalWords) * 100;
            progressFill.style.width = `${progress}%`;
            updateStats();
          }
        };

        utterance.onstart = () => {
          state.isNarrating = true;
          audioIndicator.classList.add('playing');
          audioStatus.textContent = 'Speaking';
          updateStatus('üéµ Experiencing Ancient Greece...', true);
        };

        utterance.onend = () => {
          state.isNarrating = false;
          audioIndicator.classList.remove('playing');
          audioStatus.textContent = 'Complete';
          updateStatus('‚ú® Experience complete!', true);
          progressFill.style.width = '100%';
          setTimeout(() => {
            startBtn.disabled = false;
            stopBtn.disabled = true;
          }, 2000);
        };

        utterance.onerror = (event) => {
          console.error('Speech error:', event);
          updateStatus('‚ùå Error during narration');
          audioIndicator.classList.remove('playing');
          startBtn.disabled = false;
        };

        // Start speaking
        synth.speak(utterance);
        stopBtn.disabled = false;

      } catch (error) {
        console.error('Start error:', error);
        updateStatus('‚ùå Failed to start');
        startBtn.disabled = false;
      }
    }

    function stopExperience() {
      window.speechSynthesis.cancel();

      state = {
        wordCount: 0,
        imagesShown: 0,
        isNarrating: false,
        totalWords: state.totalWords,
        utterance: null
      };

      audioIndicator.classList.remove('playing');
      audioStatus.textContent = 'Ready';
      updateStatus('Experience stopped');
      progressFill.style.width = '0%';
      updateStats();

      currentImage.classList.remove('visible');
      caption.classList.remove('visible');
      intro.classList.remove('hidden');

      startBtn.disabled = false;
      stopBtn.disabled = true;
    }

    startBtn.addEventListener('click', startExperience);
    stopBtn.addEventListener('click', stopExperience);

    // Initialize
    console.log('Greek Civilization Experience Ready');
    console.log('Total words:', state.totalWords);
    updateStats();
  </script>
</body>
</html>
